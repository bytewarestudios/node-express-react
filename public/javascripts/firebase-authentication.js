'use strict';

(function() {

  // Initializes FirebaseUserAccount.
  function FirebaseUserAccount() {
    this.initFirebase();
  }

  //todo: move this to its own file
  FirebaseUserAccount.prototype.initFirebase = function () {
    /* Initialize Firebase
     Generated by firebase, this can be retrieved by visiting
     https://console.firebase.google.com/project/{projectId}/settings/general/
     and clicking on "Add Firebase to your web app".
     */
    var config = {
      apiKey: "AIzaSyAH_6mpwyAYEV_0wd5MkBpvMPLma4G2NBo",
      authDomain: "user-accounts-93379.firebaseapp.com",
      databaseURL: "https://user-accounts-93379.firebaseio.com",
      projectId: "user-accounts-93379",
      storageBucket: "",
      messagingSenderId: "185192396136"
    };
    firebase.initializeApp(config);
  };
  /**
   * Sign in using email
   *
   * @param email
   * @param password
   */
  FirebaseUserAccount.prototype.signIn = function (email, password) {

    // Sign in using email as user name and their password
    firebase.auth().signInWithEmailAndPassword(email, password)
    .then(function (user) {
      console.log(user);
      if (firebaseUserAccount.checkSignedIn()) {
        console.log('ok to show the users account');
      }
    });
  };

  /**
   * Sign out of Firebase.
   */
  FirebaseUserAccount.prototype.signOut = function () {
    firebase.auth().signOut();
  };

  /**
   * Triggers when the auth state change for instance when the user
   * signs-in or signs-out.
   *
   * @param user
   */
  FirebaseUserAccount.prototype.onAuthStateChanged = function (user) {
    if (user) { // User is signed in!
    } else { // User is signed out!
    }
  };

  /**
   * Returns true if user is signed-in. Otherwise false and displays a message.
   *
   * @returns {boolean}
   */
  FirebaseUserAccount.prototype.checkSignedIn = function () {
    return firebase.auth().currentUser
      ? true
      : false;
  };

  document.querySelector('[data-login-in-button]')
  .addEventListener('click', function (event) {
    var userName = document.querySelector('#user_name').value;
    var password = document.querySelector('#password').value;
    console.log(userName);
    firebaseUserAccount.signIn(userName, password);
  });
  var firebaseUserAccount = new FirebaseUserAccount();

})();
